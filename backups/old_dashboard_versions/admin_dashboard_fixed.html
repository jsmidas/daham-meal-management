<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‹ìì¬ ê´€ë¦¬ ì‹œìŠ¤í…œ - ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</title>
    
    <!-- ì™¸ë¶€ CSS -->
    <link rel="stylesheet" href="static/css/admin-dashboard-main.css">
</head>
<body>
    <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
    <div class="admin-container">
        <!-- ì‚¬ì´ë“œë°” -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <h2>ğŸ½ï¸ ì‹ìì¬ ê´€ë¦¬ ì‹œìŠ¤í…œ</h2>
                <p>ê´€ë¦¬ì ì‹œìŠ¤í…œ</p>
            </div>
            
            <div class="nav-menu">
                <a href="#" class="nav-item active" data-page="dashboard">
                    <span class="icon">ğŸ“Š</span>ëŒ€ì‹œë³´ë“œ
                </a>
                <a href="#" class="nav-item" data-page="users">
                    <span class="icon">ğŸ‘¥</span>ì‚¬ìš©ì ê´€ë¦¬
                </a>
                <a href="#" class="nav-item" data-page="suppliers">
                    <span class="icon">ğŸš›</span>í˜‘ë ¥ì—…ì²´ ê´€ë¦¬
                </a>
                <a href="#" class="nav-item" data-page="business-locations">
                    <span class="icon">ğŸ¢</span>ì‚¬ì—…ì¥ ê´€ë¦¬
                </a>
                <a href="#" class="nav-item" data-page="meal-pricing">
                    <span class="icon">ğŸ’°</span>ì‹ë‹¨ê°€ ê´€ë¦¬
                </a>
                <a href="#" class="nav-item" data-page="ingredients">
                    <span class="icon">ğŸ“¦</span>ì‹ìì¬ ê´€ë¦¬
                </a>
            </div>
            
            <div class="sidebar-footer" style="margin-top: auto; padding: 20px;">
                <div style="border-top: 1px solid rgba(255,255,255,0.2); padding-top: 20px;">
                    <a href="/" class="nav-item" style="background: #e8f5e8; color: #4caf50;">
                        <span class="icon">ğŸ½ï¸</span>ê¸‰ì‹ê´€ë¦¬ë¡œ ì´ë™
                    </a>
                </div>
            </div>
        </nav>

        <!-- ë©”ì¸ ì»¨í…ì¸  -->
        <main class="main-content">
            <!-- í—¤ë” -->
            <div class="header">
                <h1 id="page-title">ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</h1>
                <div class="header-info">
                    <div class="user-info">
                        ê´€ë¦¬ìë‹˜, ì•ˆë…•í•˜ì„¸ìš”! | ì˜¤ëŠ˜: <span id="current-date"></span>
                    </div>
                    <button class="logout-btn" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
                </div>
            </div>

            <!-- í˜ì´ì§€ë³„ ì»¨í…ì¸  ì˜ì—­ -->
            <div id="content-area">
                <!-- ëŒ€ì‹œë³´ë“œ ê¸°ë³¸ ì»¨í…ì¸  -->
                <div id="dashboard-content" class="page-content">
                    <div class="dashboard-grid">
                        <div class="dashboard-card">
                            <div class="card-header">
                                <span class="icon">ğŸ‘¥</span>
                                <h3 class="card-title">ì „ì²´ ì‚¬ìš©ì</h3>
                            </div>
                            <div class="card-content">
                                <div class="stat-number" id="total-users">-</div>
                                <div class="stat-label">ë“±ë¡ëœ ì‚¬ìš©ì ìˆ˜</div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card-header">
                                <span class="icon">ğŸ¢</span>
                                <h3 class="card-title">ì‚¬ì—…ì¥</h3>
                            </div>
                            <div class="card-content">
                                <div class="stat-number" id="total-sites">-</div>
                                <div class="stat-label">ê´€ë¦¬ ì¤‘ì¸ ì‚¬ì—…ì¥</div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card-header">
                                <span class="icon">ğŸ“¦</span>
                                <h3 class="card-title">ì‹ìì¬</h3>
                            </div>
                            <div class="card-content">
                                <div class="stat-number" id="total-ingredients">-</div>
                                <div class="stat-label">ë“±ë¡ëœ ì‹ìì¬</div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card-header">
                                <span class="icon">ğŸš›</span>
                                <h3 class="card-title">í˜‘ë ¥ì—…ì²´</h3>
                            </div>
                            <div class="card-content">
                                <div class="stat-number" id="total-suppliers">-</div>
                                <div class="stat-label">ë“±ë¡ëœ í˜‘ë ¥ì—…ì²´</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ìµœê·¼ í™œë™ ë¡œê·¸ -->
                    <div class="activity-log">
                        <h3 style="margin-bottom: 20px;">ğŸ“ˆ ìµœê·¼ í™œë™</h3>
                        <div id="activity-list">
                            <div class="log-item">
                                <div class="log-time">ë¡œë”© ì¤‘...</div>
                                <div class="log-message">ì‹œìŠ¤í…œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ê³  ìˆìŠµë‹ˆë‹¤.</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ë‹¤ë¥¸ í˜ì´ì§€ ì»¨í…ì¸ ë“¤ì€ ë™ì ìœ¼ë¡œ ë¡œë“œ -->
                <div id="users-content" class="page-content" style="display: none;">
                    <!-- ì‚¬ìš©ì ê´€ë¦¬ ëª¨ë“ˆì´ ì—¬ê¸°ì— ë¡œë“œë©ë‹ˆë‹¤ -->
                </div>
                
                <div id="suppliers-content" class="page-content" style="display: none;">
                    <!-- í˜‘ë ¥ì—…ì²´ ê´€ë¦¬ ëª¨ë“ˆì´ ì—¬ê¸°ì— ë¡œë“œë©ë‹ˆë‹¤ -->
                </div>
                
                <div id="business-locations-content" class="page-content" style="display: none;">
                    <!-- ì‚¬ì—…ì¥ ê´€ë¦¬ ëª¨ë“ˆì´ ì—¬ê¸°ì— ë¡œë“œë©ë‹ˆë‹¤ -->
                </div>
                
                <div id="meal-pricing-content" class="page-content" style="display: none;">
                    <!-- ì‹ë‹¨ê°€ ê´€ë¦¬ ëª¨ë“ˆì´ ì—¬ê¸°ì— ë¡œë“œë©ë‹ˆë‹¤ -->
                </div>
                
                <div id="ingredients-content" class="page-content" style="display: none;">
                    <!-- ì‹ìì¬ ê´€ë¦¬ ëª¨ë“ˆì´ ì—¬ê¸°ì— ë¡œë“œë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </main>
    </div>

    <!-- ê°„ë‹¨í•œ ëŒ€ì‹œë³´ë“œ ìŠ¤í¬ë¦½íŠ¸ (ëª¨ë“ˆ ì‹œìŠ¤í…œ ì œê±°) -->
    <script>
        const API_BASE = 'http://127.0.0.1:8006';
        let currentPage = 'dashboard';
        
        // í˜ì´ì§€ ì •ë³´
        const pages = {
            'dashboard': 'ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ',
            'users': 'ì‚¬ìš©ì ê´€ë¦¬',
            'suppliers': 'í˜‘ë ¥ì—…ì²´ ê´€ë¦¬', 
            'business-locations': 'ì‚¬ì—…ì¥ ê´€ë¦¬',
            'meal-pricing': 'ì‹ë‹¨ê°€ ê´€ë¦¬',
            'ingredients': 'ì‹ìì¬ ê´€ë¦¬'
        };

        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ ì‹ìì¬ ê´€ë¦¬ ì‹œìŠ¤í…œ ì‹œì‘');
            
            // ë‚ ì§œ í‘œì‹œ
            updateDateTime();
            setInterval(updateDateTime, 1000);
            
            // ë„¤ë¹„ê²Œì´ì…˜ ì„¤ì •
            setupNavigation();
            
            // ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ
            loadDashboardStats();
            loadRecentActivity();
        });

        function updateDateTime() {
            const currentDateElement = document.getElementById('current-date');
            if (currentDateElement) {
                const now = new Date();
                currentDateElement.textContent = now.toLocaleDateString('ko-KR', {
                    year: 'numeric',
                    month: 'long', 
                    day: 'numeric',
                    weekday: 'short'
                });
            }
        }

        function setupNavigation() {
            const navItems = document.querySelectorAll('.nav-item[data-page]');
            navItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const page = this.dataset.page;
                    if (page) {
                        loadPage(page);
                    }
                });
            });
        }

        function loadPage(pageName) {
            console.log(`ğŸ“„ í˜ì´ì§€ ë¡œë“œ: ${pageName}`);
            
            // ë„¤ë¹„ê²Œì´ì…˜ í™œì„±í™”
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-page="${pageName}"]`).classList.add('active');

            // í˜ì´ì§€ íƒ€ì´í‹€ ì—…ë°ì´íŠ¸
            document.getElementById('page-title').textContent = pages[pageName] || pageName;

            // ëª¨ë“  í˜ì´ì§€ ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.page-content').forEach(content => {
                content.style.display = 'none';
            });

            currentPage = pageName;

            // í•´ë‹¹ í˜ì´ì§€ í‘œì‹œ ë° ë°ì´í„° ë¡œë“œ
            switch(pageName) {
                case 'dashboard':
                    document.getElementById('dashboard-content').style.display = 'block';
                    loadDashboardStats();
                    loadRecentActivity();
                    break;
                case 'users':
                    document.getElementById('users-content').style.display = 'block';
                    loadUsersPage();
                    break;
                case 'suppliers':
                    document.getElementById('suppliers-content').style.display = 'block';
                    loadSuppliersPage();
                    break;
                case 'business-locations':
                    document.getElementById('business-locations-content').style.display = 'block';
                    loadBusinessLocationsPage();
                    break;
                case 'meal-pricing':
                    document.getElementById('meal-pricing-content').style.display = 'block';
                    loadMealPricingPage();
                    break;
                case 'ingredients':
                    document.getElementById('ingredients-content').style.display = 'block';
                    loadIngredientsPage();
                    break;
            }
        }

        async function loadDashboardStats() {
            try {
                console.log('ğŸ“Š ëŒ€ì‹œë³´ë“œ í†µê³„ ë¡œë”©...');
                const response = await fetch(`${API_BASE}/api/admin/dashboard-stats`);
                const data = await response.json();
                
                if (data.success) {
                    document.getElementById('total-users').textContent = data.totalUsers || 0;
                    document.getElementById('total-sites').textContent = data.totalSites || 0;
                    document.getElementById('total-ingredients').textContent = data.totalIngredients || 0;
                    document.getElementById('total-suppliers').textContent = data.totalSuppliers || 0;
                    console.log('âœ… ëŒ€ì‹œë³´ë“œ í†µê³„ ë¡œë“œ ì™„ë£Œ');
                } else {
                    throw new Error(data.error || 'í†µê³„ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨');
                }
            } catch (error) {
                console.error('âŒ ëŒ€ì‹œë³´ë“œ í†µê³„ ë¡œë“œ ì‹¤íŒ¨:', error);
                // ê¸°ë³¸ê°’ ì„¤ì •
                document.getElementById('total-users').textContent = '0';
                document.getElementById('total-sites').textContent = '0';
                document.getElementById('total-ingredients').textContent = '0';
                document.getElementById('total-suppliers').textContent = '0';
            }
        }

        async function loadRecentActivity() {
            try {
                const response = await fetch(`${API_BASE}/api/admin/recent-activity`);
                const data = await response.json();
                
                if (data.success && data.activities) {
                    const activityList = document.getElementById('activity-list');
                    activityList.innerHTML = data.activities.map(activity => `
                        <div class="log-item">
                            <div class="log-time">${activity.time}</div>
                            <div class="log-message">${activity.user} - ${activity.action}</div>
                        </div>
                    `).join('');
                } else {
                    // ê¸°ë³¸ í™œë™ í‘œì‹œ
                    document.getElementById('activity-list').innerHTML = `
                        <div class="log-item">
                            <div class="log-time">ë°©ê¸ˆ ì „</div>
                            <div class="log-message">ê´€ë¦¬ì - ì‹œìŠ¤í…œ ì‹œì‘</div>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('ìµœê·¼ í™œë™ ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }

        async function loadUsersPage() {
            const container = document.getElementById('users-content');
            container.innerHTML = '<div style="padding: 20px; text-align: center;">ì‚¬ìš©ì ë°ì´í„° ë¡œë”© ì¤‘...</div>';
            
            try {
                const response = await fetch(`${API_BASE}/api/admin/users`);
                const data = await response.json();
                
                if (data.success) {
                    container.innerHTML = `
                        <h2 style="margin-bottom: 20px;">ğŸ‘¥ ì‚¬ìš©ì ê´€ë¦¬</h2>
                        <div style="overflow-x: auto;">
                            <table style="width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                                <thead style="background: #f8f9fa;">
                                    <tr>
                                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #e1e5e9;">ID</th>
                                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #e1e5e9;">ì‚¬ìš©ìëª…</th>
                                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #e1e5e9;">ì—°ë½ì²˜</th>
                                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #e1e5e9;">ì—­í• </th>
                                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #e1e5e9;">ìƒíƒœ</th>
                                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #e1e5e9;">ë“±ë¡ì¼</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${data.users.map(user => `
                                        <tr style="border-bottom: 1px solid #f1f3f4;">
                                            <td style="padding: 15px;">${user.id}</td>
                                            <td style="padding: 15px; font-weight: 500;">${user.username || '-'}</td>
                                            <td style="padding: 15px;">${user.contact_info || '-'}</td>
                                            <td style="padding: 15px;">
                                                <span style="padding: 4px 8px; border-radius: 4px; font-size: 12px; background: ${user.role === 'admin' ? '#e3f2fd' : '#f3e5f5'}; color: ${user.role === 'admin' ? '#1976d2' : '#7b1fa2'};">
                                                    ${user.role || '-'}
                                                </span>
                                            </td>
                                            <td style="padding: 15px;">
                                                <span style="padding: 4px 8px; border-radius: 4px; font-size: 12px; background: ${user.is_active ? '#e8f5e8' : '#ffebee'}; color: ${user.is_active ? '#4caf50' : '#f44336'};">
                                                    ${user.is_active ? 'í™œì„±' : 'ë¹„í™œì„±'}
                                                </span>
                                            </td>
                                            <td style="padding: 15px; color: #666; font-size: 14px;">${user.created_at ? user.created_at.split(' ')[0] : '-'}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                        <p style="margin-top: 15px; color: #666; font-size: 14px;">ì´ ${data.users.length}ëª…ì˜ ì‚¬ìš©ìê°€ ë“±ë¡ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>
                    `;
                } else {
                    throw new Error(data.error);
                }
            } catch (error) {
                container.innerHTML = `<div style="padding: 20px; color: #f44336; text-align: center;">âŒ ì‚¬ìš©ì ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ${error.message}</div>`;
            }
        }

        async function loadSuppliersPage() {
            const container = document.getElementById('suppliers-content');
            container.innerHTML = '<div style="padding: 20px; text-align: center;">í˜‘ë ¥ì—…ì²´ ë°ì´í„° ë¡œë”© ì¤‘...</div>';
            
            try {
                const response = await fetch(`${API_BASE}/api/admin/suppliers/enhanced`);
                const data = await response.json();
                
                if (data.success) {
                    container.innerHTML = `
                        <h2 style="margin-bottom: 20px;">ğŸš› í˜‘ë ¥ì—…ì²´ ê´€ë¦¬</h2>
                        <div style="overflow-x: auto;">
                            <table style="width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                                <thead style="background: #f8f9fa;">
                                    <tr>
                                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #e1e5e9;">ì—…ì²´ëª…</th>
                                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #e1e5e9;">ì‹ìì¬ ìˆ˜</th>
                                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #e1e5e9;">í‰ê·  ë‹¨ê°€</th>
                                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #e1e5e9;">ìƒíƒœ</th>
                                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #e1e5e9;">ìµœì¢… ì—…ë°ì´íŠ¸</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${data.suppliers.map(supplier => `
                                        <tr style="border-bottom: 1px solid #f1f3f4;">
                                            <td style="padding: 15px; font-weight: 500;">${supplier.name}</td>
                                            <td style="padding: 15px;">${supplier.ingredient_count}ê°œ</td>
                                            <td style="padding: 15px;">${supplier.avg_price}ì›</td>
                                            <td style="padding: 15px;">
                                                <span style="padding: 4px 8px; border-radius: 4px; font-size: 12px; background: #e8f5e8; color: #4caf50;">
                                                    ${supplier.status}
                                                </span>
                                            </td>
                                            <td style="padding: 15px; color: #666; font-size: 14px;">${supplier.last_updated}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                        <p style="margin-top: 15px; color: #666; font-size: 14px;">ì´ ${data.suppliers.length}ê°œì˜ í˜‘ë ¥ì—…ì²´ê°€ ë“±ë¡ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>
                    `;
                } else {
                    throw new Error(data.error);
                }
            } catch (error) {
                container.innerHTML = `<div style="padding: 20px; color: #f44336; text-align: center;">âŒ í˜‘ë ¥ì—…ì²´ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ${error.message}</div>`;
            }
        }

        async function loadBusinessLocationsPage() {
            const container = document.getElementById('business-locations-content');
            container.innerHTML = '<div style="padding: 20px; text-align: center;">ì‚¬ì—…ì¥ ë°ì´í„° ë¡œë”© ì¤‘...</div>';
            
            try {
                const response = await fetch(`${API_BASE}/api/admin/sites`);
                const data = await response.json();
                
                if (data.success) {
                    container.innerHTML = `
                        <h2 style="margin-bottom: 20px;">ğŸ¢ ì‚¬ì—…ì¥ ê´€ë¦¬</h2>
                        <div style="overflow-x: auto;">
                            <table style="width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                                <thead style="background: #f8f9fa;">
                                    <tr>
                                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #e1e5e9;">ID</th>
                                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #e1e5e9;">ì‚¬ì—…ì¥ëª…</th>
                                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #e1e5e9;">íƒ€ì…</th>
                                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #e1e5e9;">ì£¼ì†Œ</th>
                                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #e1e5e9;">ì—°ë½ì²˜</th>
                                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #e1e5e9;">ìƒíƒœ</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${data.sites.map(site => `
                                        <tr style="border-bottom: 1px solid #f1f3f4;">
                                            <td style="padding: 15px;">${site.id}</td>
                                            <td style="padding: 15px; font-weight: 500;">${site.name}</td>
                                            <td style="padding: 15px;">${site.type}</td>
                                            <td style="padding: 15px;">${site.address || '-'}</td>
                                            <td style="padding: 15px;">${site.contact_info || '-'}</td>
                                            <td style="padding: 15px;">
                                                <span style="padding: 4px 8px; border-radius: 4px; font-size: 12px; background: #e8f5e8; color: #4caf50;">
                                                    ${site.status}
                                                </span>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                        <p style="margin-top: 15px; color: #666; font-size: 14px;">ì´ ${data.sites.length}ê°œì˜ ì‚¬ì—…ì¥ì´ ë“±ë¡ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>
                    `;
                } else {
                    throw new Error(data.error);
                }
            } catch (error) {
                container.innerHTML = `<div style="padding: 20px; color: #f44336; text-align: center;">âŒ ì‚¬ì—…ì¥ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ${error.message}</div>`;
            }
        }

        function loadMealPricingPage() {
            const container = document.getElementById('meal-pricing-content');
            container.innerHTML = `
                <h2 style="margin-bottom: 20px;">ğŸ’° ì‹ë‹¨ê°€ ê´€ë¦¬</h2>
                <div style="padding: 40px; text-align: center; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                    <h3 style="color: #667eea; margin-bottom: 15px;">ğŸš§ ì¤€ë¹„ ì¤‘ì¸ ê¸°ëŠ¥</h3>
                    <p style="color: #666; line-height: 1.6;">
                        ì‹ë‹¨ê°€ ê´€ë¦¬ ê¸°ëŠ¥ì„ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.<br>
                        ê³§ ë‹¤ì–‘í•œ ì‹ë‹¨ ê°€ê²© ê´€ë¦¬ ê¸°ëŠ¥ì„ ë§Œë‚˜ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    </p>
                </div>
            `;
        }

        async function loadIngredientsPage() {
            const container = document.getElementById('ingredients-content');
            container.innerHTML = '<div style="padding: 20px; text-align: center;">ì‹ìì¬ ë°ì´í„° ë¡œë”© ì¤‘...</div>';
            
            try {
                const response = await fetch(`${API_BASE}/api/admin/ingredients-new?limit=20`);
                const data = await response.json();
                
                if (data.success) {
                    container.innerHTML = `
                        <h2 style="margin-bottom: 20px;">ğŸ“¦ ì‹ìì¬ ê´€ë¦¬</h2>
                        <div style="overflow-x: auto;">
                            <table style="width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                                <thead style="background: #f8f9fa;">
                                    <tr>
                                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #e1e5e9;">ID</th>
                                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #e1e5e9;">ì‹ìì¬ëª…</th>
                                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #e1e5e9;">ì¹´í…Œê³ ë¦¬</th>
                                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #e1e5e9;">ê³µê¸‰ì—…ì²´</th>
                                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #e1e5e9;">êµ¬ë§¤ê°€</th>
                                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #e1e5e9;">íŒë§¤ê°€</th>
                                        <th style="padding: 15px; text-align: left; border-bottom: 1px solid #e1e5e9;">ë‹¨ìœ„</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${data.ingredients.map(ingredient => `
                                        <tr style="border-bottom: 1px solid #f1f3f4;">
                                            <td style="padding: 15px;">${ingredient.id}</td>
                                            <td style="padding: 15px; font-weight: 500;">${ingredient.name}</td>
                                            <td style="padding: 15px;">${ingredient.category}</td>
                                            <td style="padding: 15px;">${ingredient.supplier}</td>
                                            <td style="padding: 15px; color: #1976d2;">${ingredient.purchase_price}ì›</td>
                                            <td style="padding: 15px; color: #388e3c;">${ingredient.selling_price}ì›</td>
                                            <td style="padding: 15px;">${ingredient.unit}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                        <p style="margin-top: 15px; color: #666; font-size: 14px;">
                            ì²˜ìŒ ${data.ingredients.length}ê°œ í•­ëª©ì„ í‘œì‹œí•©ë‹ˆë‹¤. 
                            <span style="font-weight: 500;">ì „ì²´ ${data.pagination ? data.pagination.total_items : 'N/A'}ê°œ í•­ëª©</span>
                        </p>
                    `;
                } else {
                    throw new Error(data.error);
                }
            } catch (error) {
                container.innerHTML = `<div style="padding: 20px; color: #f44336; text-align: center;">âŒ ì‹ìì¬ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ${error.message}</div>`;
            }
        }

        function logout() {
            if (confirm('ë¡œê·¸ì•„ì›ƒí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                console.log('ğŸšª ë¡œê·¸ì•„ì›ƒ');
                window.location.href = '/';
            }
        }

        console.log('ğŸ‰ ì‹ìì¬ ê´€ë¦¬ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ');
    </script>
</body>
</html>