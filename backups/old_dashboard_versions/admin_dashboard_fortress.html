<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í…ŒìŠ¤íŠ¸ ê¸‰ì‹ê´€ë¦¬ ì‹œìŠ¤í…œ - Fortress Admin</title>
    <style>
        /* ìµœì†Œí•œì˜ ìŠ¤íƒ€ì¼ë§Œ í¬í•¨ - ëª¨ë“ˆë³„ CSSëŠ” ê°ì ë¡œë“œ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Malgun Gothic', sans-serif;
            background-color: #f5f5f5;
            min-height: 100vh;
        }

        .fortress-loading {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            z-index: 9999;
        }

        .fortress-logo {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .fortress-status {
            font-size: 1.2rem;
            margin-bottom: 2rem;
        }

        .fortress-progress {
            width: 300px;
            height: 4px;
            background: rgba(255,255,255,0.3);
            border-radius: 2px;
            overflow: hidden;
        }

        .fortress-progress-bar {
            height: 100%;
            background: #ffd700;
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 2px;
        }

        .fortress-error {
            background: #dc3545 !important;
            text-align: center;
        }

        .fortress-error h2 {
            margin-bottom: 1rem;
            font-size: 2rem;
        }

        .fortress-main {
            display: none;
            min-height: 100vh;
        }

        .fortress-sidebar {
            width: 250px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
        }

        .fortress-content {
            margin-left: 250px;
            min-height: 100vh;
            padding: 0;
        }

        .fortress-module-container {
            width: 100%;
            height: 100vh;
        }

        #fortress-system-status {
            position: fixed;
            bottom: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 1000;
        }

        .fortress-protected {
            border: 2px solid #ffd700;
            position: relative;
        }

        .fortress-protected::before {
            content: 'ğŸ›¡ï¸';
            position: absolute;
            top: -10px;
            right: -10px;
            background: #ffd700;
            color: black;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <!-- ë¡œë”© í™”ë©´ -->
    <div id="fortress-loading" class="fortress-loading">
        <div class="fortress-logo">ğŸ°</div>
        <div class="fortress-status" id="fortress-status">Fortress ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì¤‘...</div>
        <div class="fortress-progress">
            <div class="fortress-progress-bar" id="fortress-progress"></div>
        </div>
        <div style="margin-top: 1rem; font-size: 0.9rem; opacity: 0.8;" id="fortress-details">
            ë³´í˜¸ëœ ì•„í‚¤í…ì²˜ë¥¼ ë¡œë”©í•˜ê³  ìˆìŠµë‹ˆë‹¤...
        </div>
    </div>

    <!-- ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ -->
    <div id="fortress-main" class="fortress-main">
        <!-- ì‚¬ì´ë“œë°” ëª¨ë“ˆ -->
        <div id="fortress-sidebar" class="fortress-sidebar fortress-protected">
            <!-- ì‚¬ì´ë“œë°” ë‚´ìš©ì€ navigation ëª¨ë“ˆì´ ë¡œë“œ -->
        </div>

        <!-- ë©”ì¸ ì»¨í…ì¸  -->
        <div class="fortress-content">
            <div id="fortress-module-container" class="fortress-module-container">
                <!-- í™œì„± ëª¨ë“ˆì´ ì—¬ê¸°ì— ë¡œë“œë©ë‹ˆë‹¤ -->
            </div>
        </div>
    </div>

    <!-- ì‹œìŠ¤í…œ ìƒíƒœ í‘œì‹œ -->
    <div id="fortress-system-status">
        ğŸ° Fortress v1.0.0 | ëª¨ë“ˆ: 0 | ìƒíƒœ: ì´ˆê¸°í™”ì¤‘
    </div>

    <!-- í•µì‹¬ í”„ë ˆì„ì›Œí¬ ë¡œë“œ (ìˆœì„œ ì¤‘ìš”!) -->
    <script src="/system/core/framework.js"></script>
    <script src="/system/core/module-registry.js"></script>
    <script src="/system/core/api-gateway.js"></script>
    <script src="/system/core/protection.js"></script>
    
    <!-- ë¹„ì¦ˆë‹ˆìŠ¤ ëª¨ë“ˆë“¤ -->
    <script src="/system/modules/ingredients/ingredients-module.js"></script>

    <!-- ë¶€íŠ¸ìŠ¤íŠ¸ë© ìŠ¤í¬ë¦½íŠ¸ -->
    <script>
        /**
         * Fortress Admin Bootstrap
         * AI-resistant initialization sequence
         */
        class FortressBootstrap {
            constructor() {
                this.loadingSteps = [
                    { name: 'ì½”ì–´ í”„ë ˆì„ì›Œí¬', progress: 20, delay: 100 },
                    { name: 'ëª¨ë“ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬', progress: 40, delay: 100 },
                    { name: 'API ê²Œì´íŠ¸ì›¨ì´', progress: 60, delay: 100 },
                    { name: 'ì‹œìŠ¤í…œ ëª¨ë“ˆ', progress: 80, delay: 200 },
                    { name: 'ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤', progress: 100, delay: 100 }
                ];
                this.currentStep = 0;
                this.startTime = Date.now();
            }

            async boot() {
                try {
                    console.log('ğŸ° Starting Fortress Admin System...');
                    
                    // ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
                    await this.showLoadingAnimation();

                    // ì‹œìŠ¤í…œ ë¬´ê²°ì„± ê²€ì¦
                    if (!this.validateSystem()) {
                        throw new Error('System integrity check failed');
                    }

                    // API Gateway ì´ˆê¸°í™”
                    window.APIGateway.initialize();

                    // ì‹œìŠ¤í…œ ëª¨ë“ˆë“¤ ì •ì˜
                    this.defineSystemModules();

                    // ë¹„ì¦ˆë‹ˆìŠ¤ ëª¨ë“ˆë“¤ ì •ì˜
                    await this.defineBusinessModules();

                    // ëª¨ë“  ëª¨ë“ˆ ë¡œë“œ
                    await window.ModuleRegistry.loadAllModules();

                    // UI í‘œì‹œ
                    await this.showMainInterface();

                    // ì‹œìŠ¤í…œ ìƒíƒœ ì—…ë°ì´íŠ¸
                    this.updateSystemStatus();

                    console.log('ğŸ‰ Fortress Admin System Ready!');

                } catch (error) {
                    console.error('ğŸ’¥ Fortress boot failed:', error);
                    this.showError(error);
                }
            }

            async showLoadingAnimation() {
                for (const step of this.loadingSteps) {
                    document.getElementById('fortress-status').textContent = 
                        `${step.name} ë¡œë”© ì¤‘...`;
                    document.getElementById('fortress-details').textContent = 
                        `${step.name}ì„(ë¥¼) ì´ˆê¸°í™”í•˜ê³  ìˆìŠµë‹ˆë‹¤...`;
                    document.getElementById('fortress-progress').style.width = 
                        `${step.progress}%`;
                    
                    await new Promise(resolve => setTimeout(resolve, step.delay));
                    this.currentStep++;
                }
            }

            validateSystem() {
                const required = ['Fortress', 'ModuleRegistry', 'APIGateway'];
                const missing = required.filter(name => !window[name]);
                
                if (missing.length > 0) {
                    console.error('âŒ Missing required systems:', missing);
                    return false;
                }

                return window.Fortress.validateIntegrity();
            }

            defineSystemModules() {
                // Navigation ëª¨ë“ˆ
                define('navigation', [], () => ({
                    name: 'navigation',
                    version: '1.0.0',
                    
                    async init() {
                        console.log('ğŸ§­ Navigation module initializing...');
                        await this.renderSidebar();
                    },
                    
                    async renderSidebar() {
                        const sidebar = document.getElementById('fortress-sidebar');
                        sidebar.innerHTML = `
                            <div style="padding: 20px; border-bottom: 1px solid rgba(255,255,255,0.2);">
                                <h2 style="font-size: 18px; font-weight: 600;">ğŸ° Fortress Admin</h2>
                                <p style="font-size: 12px; opacity: 0.8; margin-top: 5px;">ë³´í˜¸ëœ ê´€ë¦¬ ì‹œìŠ¤í…œ</p>
                            </div>
                            <nav style="padding: 20px 0;">
                                <a href="#dashboard" class="fortress-nav-item" data-module="dashboard">
                                    ğŸ“Š ëŒ€ì‹œë³´ë“œ
                                </a>
                                <a href="#ingredients" class="fortress-nav-item" data-module="ingredients-fortress">
                                    ğŸ¥¬ ì‹ìì¬ ê´€ë¦¬ (Fortress)
                                </a>
                                <a href="#users" class="fortress-nav-item" data-module="users">
                                    ğŸ‘¥ ì‚¬ìš©ì ê´€ë¦¬
                                </a>
                                <a href="#suppliers" class="fortress-nav-item" data-module="suppliers">
                                    ğŸª í˜‘ë ¥ì—…ì²´ ê´€ë¦¬
                                </a>
                                <a href="#settings" class="fortress-nav-item" data-module="settings">
                                    âš™ï¸ ì„¤ì •
                                </a>
                            </nav>
                        `;

                        // ë„¤ë¹„ê²Œì´ì…˜ ìŠ¤íƒ€ì¼
                        const style = document.createElement('style');
                        style.textContent = `
                            .fortress-nav-item {
                                display: block;
                                padding: 15px 25px;
                                color: white;
                                text-decoration: none;
                                transition: all 0.3s;
                                border-left: 3px solid transparent;
                            }
                            .fortress-nav-item:hover, .fortress-nav-item.active {
                                background: rgba(255,255,255,0.1);
                                border-left-color: #ffd700;
                            }
                        `;
                        document.head.appendChild(style);

                        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
                        sidebar.addEventListener('click', (e) => {
                            const navItem = e.target.closest('.fortress-nav-item');
                            if (navItem) {
                                e.preventDefault();
                                const module = navItem.dataset.module;
                                this.switchModule(module);
                            }
                        });
                    },

                    switchModule(moduleName) {
                        // ê¸°ì¡´ í™œì„± ë©”ë‰´ ì œê±°
                        document.querySelectorAll('.fortress-nav-item.active')
                            .forEach(item => item.classList.remove('active'));
                        
                        // ìƒˆ ë©”ë‰´ í™œì„±í™”
                        const newItem = document.querySelector(`[data-module="${moduleName}"]`);
                        if (newItem) newItem.classList.add('active');

                        // ëª¨ë“ˆ ë¡œë“œ
                        window.Fortress.sendMessage('navigation', moduleName, 'activate');
                        
                        // ì»¨í…Œì´ë„ˆ ì—…ë°ì´íŠ¸
                        const container = document.getElementById('fortress-module-container');
                        container.innerHTML = `<div style="padding: 20px; text-align: center;">
                            <h2>ğŸ”„ ${moduleName} ëª¨ë“ˆ ë¡œë”© ì¤‘...</h2>
                        </div>`;
                    },

                    destroy() {
                        console.log('ğŸ§­ Navigation module destroyed');
                    }
                }));
            }

            async defineBusinessModules() {
                // Dashboard ëª¨ë“ˆ
                define('dashboard', ['navigation'], () => ({
                    name: 'dashboard',
                    version: '1.0.0',
                    
                    async init() {
                        console.log('ğŸ“Š Dashboard module ready');
                        
                        // ë©”ì‹œì§€ ë¦¬ìŠ¤ë„ˆ
                        window.Fortress.eventBus.addEventListener('moduleMessage', (e) => {
                            if (e.detail.to === 'dashboard' && e.detail.message === 'activate') {
                                this.render();
                            }
                        });
                    },

                    async render() {
                        const container = document.getElementById('fortress-module-container');
                        container.innerHTML = `
                            <div style="padding: 20px;">
                                <h1>ğŸ“Š ëŒ€ì‹œë³´ë“œ</h1>
                                <div style="margin-top: 20px; padding: 20px; background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                                    <p>ğŸ° Fortress ë³´í˜¸ ì‹œìŠ¤í…œì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                                    <p>ëª¨ë“  ëª¨ë“ˆì´ ì•ˆì „í•˜ê²Œ ê²©ë¦¬ë˜ì–´ ë™ì‘í•©ë‹ˆë‹¤.</p>
                                    <div style="margin-top: 20px;">
                                        <strong>ì‹œìŠ¤í…œ ì •ë³´:</strong><br>
                                        - í”„ë ˆì„ì›Œí¬: Fortress v1.0.0<br>
                                        - ë¡œë“œëœ ëª¨ë“ˆ: ${Object.keys(window.ModuleRegistry.getModuleStatus()).length}ê°œ<br>
                                        - ê°€ë™ ì‹œê°„: ${Math.round((Date.now() - this.startTime) / 1000)}ì´ˆ<br>
                                        - ë³´í˜¸ ìƒíƒœ: âœ… í™œì„±í™”ë¨
                                    </div>
                                </div>
                            </div>
                        `;
                    },

                    destroy() {
                        console.log('ğŸ“Š Dashboard module destroyed');
                    }
                }));

                // ingredients-fortress ëª¨ë“ˆì€ ë³„ë„ íŒŒì¼ì—ì„œ ë¡œë“œë¨
            }

            async showMainInterface() {
                document.getElementById('fortress-loading').style.display = 'none';
                document.getElementById('fortress-main').style.display = 'block';
                
                // ê¸°ë³¸ ëŒ€ì‹œë³´ë“œ í™œì„±í™”
                setTimeout(() => {
                    const dashboardNav = document.querySelector('[data-module="dashboard"]');
                    if (dashboardNav) dashboardNav.click();
                }, 100);
            }

            updateSystemStatus() {
                const status = document.getElementById('fortress-system-status');
                const moduleCount = Object.keys(window.ModuleRegistry.getModuleStatus()).length;
                
                status.textContent = 
                    `ğŸ° Fortress v1.0.0 | ëª¨ë“ˆ: ${moduleCount} | ìƒíƒœ: ì •ìƒ`;
                
                // ì£¼ê¸°ì  ì—…ë°ì´íŠ¸
                setInterval(() => {
                    const uptime = Math.round((Date.now() - this.startTime) / 1000);
                    status.textContent = 
                        `ğŸ° Fortress v1.0.0 | ëª¨ë“ˆ: ${moduleCount} | ê°€ë™: ${uptime}s`;
                }, 5000);
            }

            showError(error) {
                document.getElementById('fortress-loading').className = 'fortress-loading fortress-error';
                document.getElementById('fortress-loading').innerHTML = `
                    <h2>ğŸš¨ ì‹œìŠ¤í…œ ì˜¤ë¥˜</h2>
                    <p>Fortress ì‹œìŠ¤í…œì„ ì´ˆê¸°í™”í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
                    <div style="margin: 20px; padding: 20px; background: rgba(255,255,255,0.2); border-radius: 10px; font-family: monospace; text-align: left;">
                        ${error.message}
                    </div>
                    <button onclick="location.reload()" style="padding: 10px 20px; background: white; color: #dc3545; border: none; border-radius: 5px; cursor: pointer;">
                        ì‹œìŠ¤í…œ ì¬ì‹œì‘
                    </button>
                `;
            }
        }

        // ì‹œìŠ¤í…œ ë¶€íŒ…
        document.addEventListener('DOMContentLoaded', async () => {
            const bootstrap = new FortressBootstrap();
            await bootstrap.boot();
        });

        // ì „ì—­ ì—ëŸ¬ í•¸ë“¤ë§
        window.addEventListener('error', (e) => {
            console.error('ğŸš¨ Global error:', e.error);
            
            if (window.Fortress) {
                window.Fortress.validateIntegrity();
            }
        });

        // ë³´í˜¸ ë©”ì‹œì§€
        console.log(`
ğŸ° ==========================================
   FORTRESS ADMIN SYSTEM
   AI-Resistant Architecture
   
   âš ï¸  ì´ ì‹œìŠ¤í…œì€ AI ì–´ì‹œìŠ¤í„´íŠ¸ì˜ 
       ë¬´ì°¨ë³„ì  ìˆ˜ì •ìœ¼ë¡œë¶€í„° ë³´í˜¸ë©ë‹ˆë‹¤.
       
   ğŸ“‹ êµ¬ì¡° ë³€ê²½ ì‹œ ë°˜ë“œì‹œ ë¬¸ì„œë¥¼ í™•ì¸í•˜ì„¸ìš”.
==========================================
        `);
    </script>
</body>
</html>