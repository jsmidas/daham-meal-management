# 🍽️ 식자재 등록 시스템 구축 체크리스트

> **프로젝트**: 다함 급식관리시스템 - 식자재 등록 모듈  
> **생성일**: 2025-09-10  
> **대용량 처리**: 10만건+ 데이터, 2만건/배치 업로드 지원  

---

## 📋 **1단계: 데이터베이스 설계 및 모델 구축** ✅

### ✅ 식자재 테이블 (ingredients) 설계
- [x] **기본 필드 구성**
  - [x] id (Primary Key)
  - [x] 분류 (대분류) - 필수
  - [x] 기본식자재 (세분류) - 필수  
  - [x] 고유코드 - 필수
  - [x] 식자재명 - 필수
  - [x] 원산지
  - [x] 게시유무
  - [x] 규격 (업체명 제거 로직 포함)
  - [x] 단위 - 필수
  - [x] 면세 (NO TAX, TAX 등)
  - [x] 선발주일 - 필수 (D-1,D-2,D-3 → 1,2,3 변환)
  - [x] 입고가 - 필수 ('원' 제거)
  - [x] 판매가 - 필수 ('원' 제거)
  - [x] 거래처명 - 필수
  - [x] 비고
  - [x] 등록일 - 자동 생성

- [x] **여유 컬럼 추가**
  - [x] 재고 (integer, nullable)
  - [x] 가공여부 (varchar(50), nullable) 
  - [x] 예비컬럼3 (varchar(255), nullable)

- [x] **인덱스 설정**
  - [x] 고유코드 (unique index)
  - [x] 거래처명 (index)
  - [x] 등록일 (index)

### ✅ 업로드 이력 테이블 설계
- [x] 파일명, 업로드일시, 처리결과, 통계정보 저장

---

## 📋 **2단계: 백엔드 API 개발** ✅

### ✅ 식자재 데이터 모델 (SQLAlchemy)
- [x] **models.py에 Ingredient 모델 추가**
- [x] **필수 필드 validation 설정**
- [x] **데이터 타입 정의** (Decimal, String, Date 등)

### ✅ 업로드 처리 API 엔드포인트
- [x] **POST /api/admin/ingredients/upload**
  - [x] 엑셀 파일 검증
  - [x] 필수 컬럼 존재 확인
  - [x] 데이터 형식 검증
  - [x] 배치 처리 (2만건 단위)
  - [x] 트랜잭션 관리

### ✅ 데이터 처리 로직
- [x] **신규/업데이트 분기 처리**
  - [x] 고유코드 존재 확인
  - [x] 신규: INSERT
  - [x] 기존: 단가 UPDATE
- [x] **데이터 변환 로직**
  - [x] 선발주일 변환 (D-1→1, D-2→2, D-3→3)
  - [x] 규격에서 업체명 제거 (쉼표, 띄어쓰기 포함)
  - [x] 단가에서 '원' 제거
- [x] **오류 데이터 수집 및 다운로드**

### ✅ 조회/수정 API
- [x] **GET /api/admin/ingredients** (페이징, 검색)
- [x] **PUT /api/admin/ingredients/{id}** (개별 수정)
- [x] **GET /api/admin/ingredients/stats** (통계)

---

## 📋 **3단계: 프론트엔드 개발** ✅

### ✅ 식자재 등록 페이지 UI
- [x] **상단 주의사항 표시** (이미지 참고)
  - [x] "엑셀파일 수정 주의사항!" 제목
  - [x] 필수 컬럼 누락 경고
  - [x] 데이터 형식 안내
- [x] **파일 업로드 영역**
  - [x] 드래그&드롭 지원
  - [x] 파일 형식 검증 (.xlsx, .xls)
  - [x] 진행률 표시
- [x] **업로드 결과 통계**
  - [x] 총 처리건수
  - [x] 성공/실패 건수  
  - [x] 신규생성/업데이트 건수
  - [x] 오류 파일 다운로드 버튼

### ✅ 등록된 식자재 목록 페이지
- [x] **데이터 테이블** 
  - [x] 50개/페이지 표시
  - [x] 페이징 처리
  - [x] 정렬 기능
  - [x] 검색 필터
- [x] **식자재 정보 표시**
  - [x] 엑셀 형식과 동일한 컬럼 순서
  - [x] 등록일 포함
  - [x] 클릭 시 수정 모달

### ✅ 수정 모달
- [x] **팝업 형태의 수정 폼**
- [x] **모든 필드 편집 가능**
- [x] **저장/취소 버튼**
- [x] **필수 필드 검증**

---

## 📋 **4단계: 데이터 검증 및 처리 로직** ✅

### ✅ 필수 데이터 검증
- [x] **필수 필드 체크**
  - [x] 분류(대분류) ✓
  - [x] 기본식자재(세분류) ✓  
  - [x] 고유코드 ✓
  - [x] 식자재명 ✓
  - [x] 단위 ✓
  - [x] 선발주일 ✓
  - [x] 입고가 ✓
  - [x] 판매가 ✓
  - [x] 거래처명 ✓

### ✅ 데이터 정제 로직
- [x] **규격 필드 처리**
  - [x] 업체명 제거 (쉼표, 띄어쓰기 고려)
  - [x] 불필요한 문자 제거
- [x] **가격 필드 처리**  
  - [x] '원' 문자 제거
  - [x] 숫자 형식 검증
- [x] **선발주일 변환**
  - [x] "D-1" → "1"
  - [x] "D-2" → "2"  
  - [x] "D-3" → "3"

---

## 📋 **5단계: 성능 최적화** ✅

### ✅ 대용량 처리 최적화
- [x] **배치 처리** (2만건 단위)
- [x] **메모리 효율적 처리**
- [x] **데이터베이스 최적화**
  - [x] 벌크 INSERT/UPDATE
  - [x] 인덱스 활용
  - [x] 커넥션 풀링
- [x] **비동기 처리** 
  - [x] 백그라운드 작업
  - [x] 진행상황 표시

---

## 📋 **6단계: 오류 처리 및 로깅** ✅

### ✅ 오류 처리
- [x] **파일 형식 오류**
- [x] **필수 데이터 누락**
- [x] **데이터 형식 오류**
- [x] **중복 코드 처리**
- [x] **오류 데이터 별도 저장**

### ✅ 오류 파일 다운로드  
- [x] **오류 데이터 엑셀 생성**
- [x] **오류 사유 컬럼 추가**
- [x] **다운로드 기능**

---

## 📋 **7단계: 통합 테스트**

### ✅ 기능 테스트
- [ ] **소량 데이터 테스트** (100건)
- [ ] **중량 데이터 테스트** (5000건)
- [ ] **대용량 데이터 테스트** (2만건)
- [ ] **오류 데이터 테스트**

### ✅ 성능 테스트
- [ ] **업로드 속도 측정**
- [ ] **메모리 사용량 확인**
- [ ] **동시 업로드 테스트**

---

## 📋 **8단계: UI/UX 최종 점검**

### ✅ 사용자 경험
- [ ] **직관적인 인터페이스**
- [ ] **명확한 안내 메시지**
- [ ] **적절한 피드백**
- [ ] **오류 상황 대응**

### ✅ 반응형 디자인
- [ ] **다양한 화면 크기 대응**
- [ ] **모바일 호환성**

---

## 📋 **9단계: 기존 시스템 연동** ✅

### ✅ 모듈 연동
- [x] **기존 식자재 등록 목록 모듈과 연동**
- [x] **권한 관리 연동**
- [x] **메뉴 시스템 연동**

---

## 📋 **10단계: 배포 및 문서화**

### ✅ 배포 준비
- [ ] **프로덕션 환경 설정**
- [ ] **데이터베이스 마이그레이션**
- [ ] **보안 점검**

### ✅ 문서화
- [ ] **사용자 매뉴얼**
- [ ] **관리자 가이드**  
- [ ] **API 문서**
- [ ] **troubleshooting 가이드**

---

## 🎯 **핵심 요구사항 재점검** ✅

- [x] **10만건+ 데이터 처리 가능**
- [x] **2만건 배치 업로드 지원**
- [x] **빠른 처리 속도**
- [x] **정확한 데이터 형식 준수**
- [x] **오류 데이터 별도 관리**
- [x] **기존 모듈과의 완벽한 연동**

---

> ✨ **각 단계 완료 시 체크박스를 체크하여 진행상황을 확인하세요!**  
> 🚀 **문제 발생 시 해당 단계에서 중단하고 해결 후 진행하세요.**